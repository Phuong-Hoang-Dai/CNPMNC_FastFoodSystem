@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@using Newtonsoft.Json
@{
    
}
<script src="~/lib/Chart.js/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json2/20150503/json2.min.js"></script>
<script src="~/js/Analyzing.js"></script>
<script src="~/js/RouteChart.js"></script>
<script src="~/js/LineChart.js"></script>

@{
    Layout = "~/Views/Shared/_mLayout.cshtml";
}

<!-- Tabs navs -->
<ul class="nav nav-tabs mb-3" id="ex1" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active" data-mdb-toggle="tab" href="#ex1-tabs-1" role="tab" aria-controls="ex1-tabs-1" aria-selected="true" onclick="showChart('day');">Ngày</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link" data-mdb-toggle="tab" href="#ex1-tabs-2" role="tab" aria-controls="ex1-tabs-2" aria-selected="false" onclick="showChart('month');">Tháng</a>
    </li>
</ul>
<!-- Tabs content -->
<div class="tab-content" style="display: flex; flex-direction: column;">
    <div class="tab-pane fade show active" id="ex1-tabs-1">
        <h1 class="text-center mt-3">Biểu đồ thống kê đơn theo thời gian (Ngày)</h1>
        <canvas id="myBarChartDay" width="400" height="200"></canvas>
    </div>
    <div class="tab-pane fade" id="ex1-tabs-2">
        <h1 class="text-center mt-3">Biểu đồ thống kê đơn theo thời gian (Tháng)</h1>
        <canvas id="myBarChartMonth" width="400" height="200"></canvas>
    </div>
</div>

<script>
    var orderCountsByMonth = @Html.Raw(JsonConvert.SerializeObject(ViewBag.OrderCountsByMonth));
    var orderCountsByDay = @Html.Raw(JsonConvert.SerializeObject(ViewBag.OrderCountsByDay));

    // Lấy thẻ canvas và context
    var ctxDay = document.getElementById('myBarChartDay').getContext('2d');
    var ctxMonth = document.getElementById('myBarChartMonth').getContext('2d');
    var tabLinkDay = document.querySelector('a[data-mdb-toggle="tab"][href="#ex1-tabs-1"]');
    var tabLinkMonth = document.querySelector('a[data-mdb-toggle="tab"][href="#ex1-tabs-2"]');
    // Khởi tạo cả hai biểu đồ
    initChart(ctxDay, orderCountsByDay);
    initChart(ctxMonth, orderCountsByMonth);

    function showChart(type) {
        var chartContainerDay = document.getElementById('ex1-tabs-1');
        var chartContainerMonth = document.getElementById('ex1-tabs-2');

        if (type === 'day') {
            chartContainerDay.classList.add('show', 'active');
            chartContainerMonth.classList.remove('show', 'active');
            tabLinkDay.classList.add('active');
            tabLinkMonth.classList.remove('active');
        } else if (type === 'month') {
            chartContainerDay.classList.remove('show', 'active');
            chartContainerMonth.classList.add('show', 'active');
            tabLinkDay.classList.remove('active');
            tabLinkMonth.classList.add('active');
        }
    }
</script>



<div class="row">
    <div class="col">
        <h2 class="mt-3">Thống kê loại hàng:</h2>
        <div style="max-width: 400px;">
            <canvas id="categoriesChart" width="400" height="200"></canvas>
        </div>
        <script>
            // Dữ liệu sản phẩm và số đơn hàng tương ứng
            var categoriesData = JSON.parse('@Html.Raw(ViewBag.CategoriesRates)');
            initRouteChart(categoriesData);
        </script>

    </div>
    <div class="col">
        <h2 class="mt-3">Doanh thu:</h2>
        <div >
            <canvas id="revenueChart"></canvas>
        </div>
    </div>
    <canvas id="revenueChart" width="400" height="200"></canvas>

    <script>
        var revenueData = @Html.Raw(JsonConvert.SerializeObject(ViewBag.RevenueByMonth));
        // Lấy thẻ canvas
        initLineChart(revenueData);
    </script>

</div>
<!-- Tabs content -->


